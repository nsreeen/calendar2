<!DOCTYPE html>
<html lang="en">
<meta charset="UTF-8">
<title>Page Title</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<link rel="stylesheet" href="">
<style>
  html {
    box-sizing: border-box;
    margin: 0;
  }

  body {
    margin: 0;
    background-color: #333;
  }

  .container {
    max-width: 1500px;
    width: 90%;
    margin: 10px auto 0;
  }

  .grid {
    display: grid;
    grid-template-columns: repeat(5, 18%);
    grid-gap: 10px;
    align-items: center;
  }

  .row {
    display: flex;
    justify-content: space-around;
  }

  .day-names {
    background-color: #000;
    color: aliceblue;
    padding: 10px;
    text-align: center;
    margin-bottom: 0;
  }

  .data {
    background-color: aliceblue;
    color: #000;
    height: 540px;
  }

  .event {
    background-color: #dcdcdc;
    margin-bottom: 5px;
    float: left;
    width: 100%;
  }

  .summary {
    font-size: 12px;
    margin: 0;
  }

  .timing {
    font-size: 8px;
    margin: 0;
    float: left;
    margin-right: 5px;
  }
</style>

<body>

  <!-- <table>
  <tr>
    <td>Monday</td>
    <td>Tuesday</td>
    <td>Wednesday</td>
    <td>Thursday</td>
    <td>Friday</td>
  </tr>
  <tr>
    <td id="0"></td>
    <td id="1"></td>
    <td id="2"></td>
    <td id="3"></td>
    <td id="4"></td>
  </tr>
</table> -->

  <div class="container">
    <div class="grid">

      <p class="day-names">Monday</p>
      <p class="day-names">Tuesday</p>
      <p class="day-names">Wednesday</p>
      <p class="day-names">Thursday</p>
      <p class="day-names">Friday</p>

      <div id="MONDAY" class="data"></div>
      <div id="TUESDAY" class="data"></div>
      <div id="WEDNESDAY" class="data"></div>
      <div id="THURSDAY" class="data"></div>
      <div id="FRIDAY" class="data"></div>

    </div>

    <!-- <div id="calendar">
      <table>
        <tr>
          <td class="day-names">Monday</td>
          <td class="day-names">Tuesday</td>
          <td class="day-names">Wednesday</td>
          <td class="day-names">Thursday</td>
          <td class="day-names">Friday</td>
        <tr>

      </table>
    </div> -->

    <!-- <div>
      Add an event!
      <input type="summary" id="summary">
      <input type="start" id="start">
      <input type="end" id="end">
    </div> -->
  </div>

  <script>
  // const tz = Intl.DateTimeFormat().resolvedOptions().timeZone;
  // console.log(tz);
    const Http = new XMLHttpRequest();
    Http.responseType = "json";
    const url = "http://127.0.0.1:8080/";
    Http.open("GET", url);
    Http.send();
    Http.onload = function () {
      for (let i = 0; i < Http.response.length; i++) {
        let day_of_week = Http.response[i]["dayOfWeek"];
        let summary = Http.response[i]["summary"];
        let start = new Date(Http.response[i]["start"]);
        let end = new Date(Http.response[i]["end"]);
        // document.getElementById(day_of_week).innerHTML += `<p>${summary} at ${new Date(start)}</p>`
        //2022-08-25T20:00Z index.html:151:17
        console.log(Http.response[i]["start"]);
        const dayStartHour = 12;
        const dayStartMinute = 00;
        const sods = `${Http.response[i]["start"].split("T")[0]}T${String(dayStartHour).padStart(2, '0')}:${String(dayStartMinute).padStart(2, '0')}Z`
        console.log(sods);
        const startOfDay = new Date(sods);
        const offset = (start - startOfDay) / 60000;
        const length = (end - start) / 60000;
        console.log(offset);


        const eventDiv = document.createElement("div");
        eventDiv.className = "event";
        eventDiv.style.height = `${length - 5}px`
        eventDiv.style.marginTop = `${offset - 5}px`

        const timingDiv = document.createElement("div");
        timingDiv.className = "timing";
        timingDiv.innerHTML = `${start.toString().split(" ")[4].split(":").splice(0,2).join(":")}-${end.toString().split(" ")[4].split(":").splice(0,2).join(":")}`;
        eventDiv.appendChild(timingDiv);

        // const summaryText = document.createTextNode(summary);
        // summaryText.className = "summary";
        // eventDiv.appendChild(summaryText);
        const summaryText = document.createElement("div");
        summaryText.className = "summary";
        summaryText.innerHTML = summary;
        eventDiv.appendChild(summaryText);


        document.getElementById(day_of_week).appendChild(eventDiv);
      }

    }

  </script>
</body>

</html>
